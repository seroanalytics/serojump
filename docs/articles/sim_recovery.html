<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Case Study 1: Simulation Recovery â€¢ serojump</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case Study 1: Simulation Recovery"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">serojump</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/data_format.html">Data format for input files `data_sero`, `exposure_data`, and `attack_rate_data`</a></li>
    <li><a class="dropdown-item" href="../articles/model_define.html">Explanation of Observational and Antibody Kinetics Models</a></li>
    <li><a class="dropdown-item" href="../articles/sim_recovery.html">Case Study 1: Simulation Recovery</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Case Study 1: Simulation Recovery</h1>
                        <h4 data-toc-skip class="author">David
Hodgson</h4>
            
            <h4 data-toc-skip class="date">2024-10-14</h4>
      

      <div class="d-none name"><code>sim_recovery.Rmd</code></div>
    </div>

    
    
<div id="r-code-description" class="section level1">
<h1>R Code Description</h1>
<p>This document describes the steps and components of the provided R
code for creating and running serological models using simulated data.
The code defines observational models, antibody kinetics models, and
runs inference using MCMC methods.</p>
<hr />
<div id="step-1-load-required-libraries" class="section level2">
<h2>Step 1: Load Required Libraries</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(devtools)</span></code></pre></div>
<pre><code>## Loading required package: usethis</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## â”€â”€ [1mAttaching core tidyverse packages[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
## [32mâœ”[39m [34mdplyr    [39m 1.1.4     [32mâœ”[39m [34mreadr    [39m 2.1.5
## [32mâœ”[39m [34mforcats  [39m 1.0.0     [32mâœ”[39m [34mstringr  [39m 1.5.1
## [32mâœ”[39m [34mggplot2  [39m 3.5.1     [32mâœ”[39m [34mtibble   [39m 3.2.1
## [32mâœ”[39m [34mlubridate[39m 1.9.3     [32mâœ”[39m [34mtidyr    [39m 1.3.1
## [32mâœ”[39m [34mpurrr    [39m 1.0.2</code></pre>
<pre><code>## â”€â”€ [1mConflicts[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
## [31mâœ–[39m [34mdplyr[39m::[32mfilter()[39m masks [34mstats[39m::filter()
## [31mâœ–[39m [34mdplyr[39m::[32mlag()[39m    masks [34mstats[39m::lag()
## [36mâ„¹[39m Use the conflicted package ([3m[34m&lt;http://conflicted.r-lib.org/&gt;[39m[23m) to force all conflicts to become errors</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(serojump)</span></code></pre></div>
<pre><code>## Warning: replacing previous import &#39;foreach::when&#39; by &#39;purrr::when&#39; when
## loading &#39;serojump&#39;</code></pre>
<pre><code>## Warning: replacing previous import &#39;foreach::accumulate&#39; by &#39;purrr::accumulate&#39;
## when loading &#39;serojump&#39;</code></pre>
</div>
<div id="step-2-read-simulated-data" class="section level2">
<h2>Step 2: Read Simulated Data</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>modelname_sim <span class="ot">&lt;-</span> <span class="st">&quot;cesCOP_notd&quot;</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>obs_er <span class="ot">&lt;-</span> <span class="st">&quot;0.5&quot;</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>modeli <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;outputs&quot;</span>, <span class="st">&quot;sim_data&quot;</span>, modelname_sim, <span class="st">&quot;inputs.RDS&quot;</span>))</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;outputs&quot;</span>, <span class="st">&quot;sim_data&quot;</span>, modelname_sim, <span class="fu">paste0</span>(<span class="st">&quot;sim_data_&quot;</span>, obs_er, <span class="st">&quot;.rds&quot;</span>)))</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>data_titre_model <span class="ot">&lt;-</span> res<span class="sc">$</span>observed_biomarker_states <span class="sc">%&gt;%</span> <span class="fu">select</span>(i, t, value) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">id =</span> i, <span class="at">time =</span> t, <span class="at">titre =</span> value) </span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>data_titre_model <span class="ot">&lt;-</span> data_titre_model <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">biomarker =</span> <span class="st">&quot;sVNT&quot;</span>) <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">sVNT =</span> titre)</span></code></pre></div>
</div>
<div id="step-3-define-likelihood-and-kinetics-functions"
class="section level2">
<h2>Step 3: Define Likelihood and Kinetics Functions</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>obsLogLikelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(titre_val, titre_est, pars) {</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    ll <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(titre_val, titre_est, pars[<span class="dv">1</span>], <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>}</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>infSerumKinetics <span class="ot">&lt;-</span> <span class="cf">function</span>(titre_est, timeSince, pars) {</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    a <span class="ot">&lt;-</span> pars[<span class="dv">1</span>]</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    b <span class="ot">&lt;-</span> pars[<span class="dv">2</span>]</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>    c <span class="ot">&lt;-</span> pars[<span class="dv">3</span>]</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>    <span class="cf">if</span> (timeSince <span class="sc">&lt;</span> <span class="dv">14</span>) {</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>        titre_est <span class="ot">&lt;-</span> titre_est <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">exp</span>(a) <span class="sc">+</span> <span class="fu">exp</span>(c)) <span class="sc">*</span> (timeSince) <span class="sc">/</span> <span class="dv">14</span>;</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>        titre_est <span class="ot">&lt;-</span> titre_est <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">exp</span>(a) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>b<span class="sc">/</span><span class="dv">10</span> <span class="sc">*</span> (timeSince <span class="sc">-</span> <span class="dv">14</span>)) <span class="sc">+</span> <span class="fu">exp</span>(c));</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>    }</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>    titre_est</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>}</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>noInfSerumKinetics <span class="ot">&lt;-</span> <span class="cf">function</span>(titre_est, timeSince, pars) {</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>    titre_est_log <span class="ot">&lt;-</span> titre_est <span class="sc">-</span> pars[<span class="dv">1</span>] <span class="sc">*</span> (timeSince)</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>    titre_est_log <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, titre_est_log)</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>    titre_est_log</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="step-4-define-the-observational-and-kinetics-models"
class="section level2">
<h2>Step 4: Define the Observational and Kinetics Models</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Define the biomarkers and exposure types in the model</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>biomarkers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sVNT&quot;</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>exposureTypes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;inf&quot;</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>exposureFitted <span class="ot">&lt;-</span> <span class="st">&quot;inf&quot;</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co"># Define the observational model</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>observationalModel <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;sVNT&quot;</span>),</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="at">model =</span> <span class="fu">makeModel</span>(</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>        <span class="fu">addObservationalModel</span>(<span class="st">&quot;sVNT&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>), obsLogLikelihood)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>        ), <span class="co"># observational model,</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">bind_rows</span>(</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>            <span class="fu">add_par_df</span>(<span class="st">&quot;sigma&quot;</span>, <span class="fl">0.0001</span>, <span class="dv">4</span>, <span class="st">&quot;unif&quot;</span>, <span class="fl">0.0001</span>, <span class="dv">4</span>)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>    )</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>)</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co"># Define the antibody kinetics model</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>abkineticsModel <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>    <span class="at">model =</span> <span class="fu">makeModel</span>(</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>            <span class="fu">addAbkineticsModel</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;sVNT&quot;</span>, <span class="st">&quot;none&quot;</span>,  <span class="fu">c</span>(<span class="st">&quot;wane&quot;</span>), noInfSerumKinetics),</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>            <span class="fu">addAbkineticsModel</span>(<span class="st">&quot;inf&quot;</span>, <span class="st">&quot;sVNT&quot;</span>, <span class="st">&quot;inf&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), infSerumKinetics)</span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>        ),</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">bind_rows</span>(</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>        <span class="fu">add_par_df</span>(<span class="st">&quot;wane&quot;</span>, <span class="fl">0.0</span>, <span class="fl">0.01</span>, <span class="st">&quot;unif&quot;</span>, <span class="fl">0.0</span>, <span class="fl">0.01</span>), <span class="co"># observational model</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>        <span class="fu">add_par_df</span>(<span class="st">&quot;a&quot;</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="st">&quot;norm&quot;</span>,  <span class="dv">2</span>, <span class="dv">2</span>), <span class="co"># ab kinetics</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>        <span class="fu">add_par_df</span>(<span class="st">&quot;b&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="st">&quot;norm&quot;</span>,  <span class="fl">0.3</span>, <span class="fl">0.05</span>), <span class="co"># ab kinetics</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>        <span class="fu">add_par_df</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="st">&quot;unif&quot;</span>, <span class="dv">0</span>,  <span class="dv">4</span>) <span class="co"># ab kinetics </span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>    )</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a>)</span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a>inf_prior <span class="ot">&lt;-</span> <span class="cf">function</span>(N, E, I, K) {</span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a>    N_adj <span class="ot">&lt;-</span> N <span class="sc">-</span> K</span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a>    E_adj <span class="ot">&lt;-</span> E <span class="sc">-</span> K </span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a>    logPriorExpInf <span class="ot">&lt;-</span> <span class="fu">lfactorial</span>(E_adj) <span class="sc">+</span> <span class="fu">lfactorial</span>(N_adj <span class="sc">-</span> E_adj) <span class="sc">-</span> <span class="fu">lfactorial</span>(N_adj ) </span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a>    logPriorExpInf</span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a>}</span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a>modeldefinition_cop <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a>    <span class="at">biomarkers =</span> biomarkers,</span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a>    <span class="at">exposureTypes =</span> exposureTypes,</span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a>    <span class="at">exposureFitted =</span> exposureFitted,</span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a>    <span class="at">observationalModel =</span> observationalModel,</span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a>    <span class="at">abkineticsModel =</span> abkineticsModel,</span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a>    <span class="at">expInfPrior =</span> inf_prior</span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a>)</span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a>model_cop <span class="ot">&lt;-</span> <span class="fu">createSeroJumpModel</span>(data_titre_model, <span class="cn">NULL</span>, modeldefinition_cop)</span></code></pre></div>
<pre><code>## OUTLINE OF INPUTTED MODEL
## There are  1  measured biomarkers:  sVNT 
## There are  2  exposure types in the study period:  none, inf 
## The fitted exposure type is  inf 
## PRIOR DISTRIBUTIONS 
## Prior parameters of observationalModel are:  sigma 
## Prior parameters of abkineticsModel are:  wane, a, b, c 
## Exposure rate is not defined over the time period. Defaulting to uniform distribution between 1 and  119 .</code></pre>
</div>
<div id="step-5-define-the-complete-model" class="section level2">
<h2>Step 5: Define the Complete Model</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>modelname_sim <span class="ot">&lt;-</span> <span class="st">&quot;cesNoCOP_notd&quot;</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>obs_er <span class="ot">&lt;-</span> <span class="st">&quot;0.5&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>modeli <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;outputs&quot;</span>, <span class="st">&quot;sim_data&quot;</span>, modelname_sim, <span class="st">&quot;inputs.RDS&quot;</span>))</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;outputs&quot;</span>, <span class="st">&quot;sim_data&quot;</span>, modelname_sim, <span class="fu">paste0</span>(<span class="st">&quot;sim_data_&quot;</span>, obs_er, <span class="st">&quot;.rds&quot;</span>)))</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>data_titre_model <span class="ot">&lt;-</span> res<span class="sc">$</span>observed_biomarker_states <span class="sc">%&gt;%</span> <span class="fu">select</span>(i, t, value) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">id =</span> i, <span class="at">time =</span> t, <span class="at">titre =</span> value) </span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>data_titre_model <span class="ot">&lt;-</span> data_titre_model <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">biomarker =</span> <span class="st">&quot;sVNT&quot;</span>) <span class="sc">%&gt;%</span> as.data.frame <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">sVNT =</span> titre)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>obsLogLikelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(titre_val, titre_est, pars) {</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>    ll <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(titre_val, titre_est, pars[<span class="dv">1</span>], <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>}</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>infSerumKinetics <span class="ot">&lt;-</span> <span class="cf">function</span>(titre_est, timeSince, pars) {</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>    a <span class="ot">&lt;-</span> pars[<span class="dv">1</span>]</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>    b <span class="ot">&lt;-</span> pars[<span class="dv">2</span>]</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>    c <span class="ot">&lt;-</span> pars[<span class="dv">3</span>]</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>    <span class="cf">if</span> (timeSince <span class="sc">&lt;</span> <span class="dv">14</span>) {</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>        titre_est <span class="ot">&lt;-</span> titre_est <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">exp</span>(a) <span class="sc">+</span> <span class="fu">exp</span>(c)) <span class="sc">*</span> (timeSince) <span class="sc">/</span> <span class="dv">14</span>;</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>        titre_est <span class="ot">&lt;-</span> titre_est <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">exp</span>(a) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>b<span class="sc">/</span><span class="dv">10</span> <span class="sc">*</span> (timeSince <span class="sc">-</span> <span class="dv">14</span>)) <span class="sc">+</span> <span class="fu">exp</span>(c));</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>    }</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>    titre_est</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>}</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>noInfSerumKinetics <span class="ot">&lt;-</span> <span class="cf">function</span>(titre_est, timeSince, pars) {</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>    titre_est_log <span class="ot">&lt;-</span> titre_est <span class="sc">-</span> pars[<span class="dv">1</span>] <span class="sc">*</span> (timeSince)</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>    titre_est_log <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, titre_est_log)</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>    titre_est_log</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Define the biomarkers and exposure types in the model</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>biomarkers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sVNT&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>exposureTypes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;inf&quot;</span>)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>exposureFitted <span class="ot">&lt;-</span> <span class="st">&quot;inf&quot;</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co"># Define the observational model</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>observationalModel <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>    <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;sVNT&quot;</span>),</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    <span class="at">model =</span> <span class="fu">makeModel</span>(</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>        <span class="fu">addObservationalModel</span>(<span class="st">&quot;sVNT&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>), obsLogLikelihood)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>        ), <span class="co"># observational model,</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">bind_rows</span>(</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>            <span class="fu">add_par_df</span>(<span class="st">&quot;sigma&quot;</span>, <span class="fl">0.0001</span>, <span class="dv">2</span>, <span class="st">&quot;exp&quot;</span>, <span class="dv">1</span>, <span class="cn">NA</span>)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>    )</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>)</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co"># Define the antibody kinetics model</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>abkineticsModel <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>    <span class="at">model =</span> <span class="fu">makeModel</span>(</span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>            <span class="fu">addAbkineticsModel</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;sVNT&quot;</span>, <span class="st">&quot;none&quot;</span>,  <span class="fu">c</span>(<span class="st">&quot;wane&quot;</span>), noInfSerumKinetics),</span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>            <span class="fu">addAbkineticsModel</span>(<span class="st">&quot;inf&quot;</span>, <span class="st">&quot;sVNT&quot;</span>, <span class="st">&quot;inf&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), infSerumKinetics)</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>        ),</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">bind_rows</span>(</span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>        <span class="fu">add_par_df</span>(<span class="st">&quot;wane&quot;</span>, <span class="fl">0.0</span>, <span class="fl">0.01</span>, <span class="st">&quot;unif&quot;</span>, <span class="fl">0.0</span>, <span class="fl">0.01</span>), <span class="co"># observational model</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>        <span class="fu">add_par_df</span>(<span class="st">&quot;a&quot;</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="st">&quot;norm&quot;</span>,  <span class="dv">2</span>, <span class="dv">2</span>), <span class="co"># ab kinetics</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a>        <span class="fu">add_par_df</span>(<span class="st">&quot;b&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="st">&quot;norm&quot;</span>,  <span class="fl">0.3</span>, <span class="fl">0.05</span>), <span class="co"># ab kinetics</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>        <span class="fu">add_par_df</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="st">&quot;unif&quot;</span>, <span class="dv">0</span>,  <span class="dv">4</span>) <span class="co"># ab kinetics </span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>    )</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>)</span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a>inf_prior <span class="ot">&lt;-</span> <span class="cf">function</span>(N, E, I, K) {</span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a>    N_adj <span class="ot">&lt;-</span> N <span class="sc">-</span> K</span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a>    E_adj <span class="ot">&lt;-</span> E <span class="sc">-</span> K </span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a>    logPriorExpInf <span class="ot">&lt;-</span> <span class="fu">lfactorial</span>(E_adj) <span class="sc">+</span> <span class="fu">lfactorial</span>(N_adj <span class="sc">-</span> E_adj) <span class="sc">-</span> <span class="fu">lfactorial</span>(N_adj ) </span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a>    logPriorExpInf</span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a>}</span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a></span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a>modeldefinition_no_cop <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a>    <span class="at">biomarkers =</span> biomarkers,</span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a>    <span class="at">exposureTypes =</span> exposureTypes,</span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a>    <span class="at">exposureFitted =</span> exposureFitted,</span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a>    <span class="at">observationalModel =</span> observationalModel,</span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a>    <span class="at">abkineticsModel =</span> abkineticsModel,</span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a>    <span class="at">expInfPrior =</span> inf_prior</span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a>)</span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a></span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a>model_no_cop <span class="ot">&lt;-</span> <span class="fu">createSeroJumpModel</span>(data_titre_model, <span class="cn">NULL</span>, modeldefinition_no_cop)</span></code></pre></div>
<pre><code>## OUTLINE OF INPUTTED MODEL
## There are  1  measured biomarkers:  sVNT 
## There are  2  exposure types in the study period:  none, inf 
## The fitted exposure type is  inf 
## PRIOR DISTRIBUTIONS 
## Prior parameters of observationalModel are:  sigma 
## Prior parameters of abkineticsModel are:  wane, a, b, c 
## Exposure rate is not defined over the time period. Defaulting to uniform distribution between 1 and  119 .</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>rj_settings <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>        <span class="at">numberChainRuns =</span> <span class="dv">4</span>, </span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>        <span class="at">iterations =</span> <span class="dv">400000</span>,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>        <span class="at">burninPosterior =</span> <span class="dv">200000</span>,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>        <span class="at">thin =</span> <span class="dv">1000</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>    )</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>save_info_cop <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>    <span class="at">file_name =</span> <span class="st">&quot;simulated_data&quot;</span>,</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>    <span class="at">model_name =</span> <span class="st">&quot;cop&quot;</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>)</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>save_info_no_cop <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>    <span class="at">file_name =</span> <span class="st">&quot;simulated_data&quot;</span>,</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>    <span class="at">model_name =</span> <span class="st">&quot;no_cop&quot;</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>)</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co"># Run these </span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#model_summary_cop &lt;- runInfRJMCMC(model_cop, rj_settings, save_info = save_info_cop)</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#model_summary_no_cop &lt;- runInfRJMCMC(model_no_cop, rj_settings, save_info = save_info_no_cop)</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>model_summary_cop <span class="ot">&lt;-</span>  <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;outputs&quot;</span>, <span class="st">&quot;fits&quot;</span>, save_info_cop<span class="sc">$</span>file_name, save_info_cop<span class="sc">$</span>model_name, <span class="fu">paste0</span>(<span class="st">&quot;model_summary.RDS&quot;</span>)))</span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>model_summary_no_cop <span class="ot">&lt;-</span>  <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;outputs&quot;</span>, <span class="st">&quot;fits&quot;</span>, save_info_no_cop<span class="sc">$</span>file_name, save_info_no_cop<span class="sc">$</span>model_name, <span class="fu">paste0</span>(<span class="st">&quot;model_summary.RDS&quot;</span>)))</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co"># Need to have save_info defined to run these</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a>modelname_sim <span class="ot">&lt;-</span> <span class="st">&quot;cesCOP_notd&quot;</span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a>sim_model_cop <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;outputs&quot;</span>, <span class="st">&quot;sim_data&quot;</span>, modelname_sim, <span class="st">&quot;inputs.RDS&quot;</span>))</span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a>sim_res_cop <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;outputs&quot;</span>, <span class="st">&quot;sim_data&quot;</span>, modelname_sim, <span class="fu">paste0</span>(<span class="st">&quot;sim_data_&quot;</span>, <span class="st">&quot;0.5&quot;</span>, <span class="st">&quot;.rds&quot;</span>)))</span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a><span class="fu">plotMCMCDiagnosis</span>(model_summary_cop, <span class="at">save_info =</span> save_info_cop)</span></code></pre></div>
<pre><code>## --CHECKING SAVE_INFO DATA--
## Saving model outputs to:  /Users/lshdh2/Dropbox/Mac (3)/Documents/research/rjmcmc/Rpackage/serojump/outputs/fits/simulated_data/cop 
##  num [1:200, 1:200] -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...</code></pre>
<pre><code>## [1m[22mSaving 7.29 x 20 in image
## [1m[22m`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## [1m[22m`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## Loading required package: bayesplot
## 
## This is bayesplot version 1.11.1
## 
## - Online documentation and vignettes at mc-stan.org/bayesplot
## 
## - bayesplot theme set to bayesplot::theme_default()
## 
##    * Does _not_ affect other ggplot2 plots
## 
##    * See ?bayesplot_theme_set for details on theme setting
## 
## Loading required package: posterior
## 
## This is posterior version 1.6.0
## 
## 
## Attaching package: &#39;posterior&#39;
## 
## 
## The following object is masked from &#39;package:bayesplot&#39;:
## 
##     rhat
## 
## 
## The following objects are masked from &#39;package:stats&#39;:
## 
##     mad, sd, var
## 
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     %in%, match
## 
## 
## [1m[22mSaving 7.29 x 20 in image
## [1m[22m`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## Loading required package: data.table
## 
## 
## Attaching package: &#39;data.table&#39;
## 
## 
## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     hour, isoweek, mday, minute, month, quarter, second, wday, week,
##     yday, year
## 
## 
## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     between, first, last
## 
## 
## The following object is masked from &#39;package:purrr&#39;:
## 
##     transpose</code></pre>
<pre><code>## Warning: [1m[22mSpecifying the `id_cols` argument by position was deprecated in tidyr 1.3.0.
## [36mâ„¹[39m Please explicitly name `id_cols`, like `id_cols = !chain`.
## [36mâ„¹[39m The deprecated feature was likely used in the [34mserojump[39m package.
##   Please report the issue to the authors.
## [90mThis warning is displayed once every 8 hours.[39m
## [90mCall `lifecycle::last_lifecycle_warnings()` to see where this warning was[39m
## [90mgenerated.[39m</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">plotPostFigsSim</span>(model_summary_cop, sim_model_cop, sim_res_cop, <span class="at">save_info =</span> save_info_cop)</span></code></pre></div>
<pre><code>## --CHECKING SAVE_INFO DATA--
## Saving model outputs to:  /Users/lshdh2/Dropbox/Mac (3)/Documents/research/rjmcmc/Rpackage/serojump/outputs/fits/simulated_data/cop</code></pre>
<pre><code>## [1m[22mJoining with `by = join_by(id)`
## Joining with `by = join_by(id)`
## Joining with `by = join_by(id)`
## `geom_smooth()` using formula = &#39;y ~ x&#39;
## Loading required package: ggdist
## Loading required package: patchwork
## Joining with `by = join_by(id)`
## Joining with `by = join_by(id)`</code></pre>
<pre><code>## Warning: [1m[22mRemoved 1 row containing missing values or values outside the scale range
## (`geom_segment()`).</code></pre>
<pre><code>## Warning: [1m[22mRemoved 1 row containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<pre><code>## [1m[22m`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: [1m[22mRemoved 1 row containing missing values or values outside the scale range
## (`geom_segment()`).
## [1m[22mRemoved 1 row containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<pre><code>## Loading required package: future</code></pre>
<pre><code>## 
##  Get order of all entries, 
## Get exposure ids, 
## Get exposure ids1,</code></pre>
<pre><code>## [1m[22mAdding missing grouping variables: `biomarker`</code></pre>
<pre><code>## Get exposure ids2, 
## Get exposure ids3, 
## Get exposure ids3, 
## Calculate trajectories for for subsets of  none</code></pre>
<pre><code>## Calculate trajectories for for subsets of  High</code></pre>
<pre><code>## [[1]]
## [1] &quot;/Users/lshdh2/Dropbox/Mac (3)/Documents/research/rjmcmc/Rpackage/serojump/outputs/fits/simulated_data/cop/figs/post/ab_kinetics_trajectories_none.png&quot;
## 
## [[2]]
## [1] &quot;/Users/lshdh2/Dropbox/Mac (3)/Documents/research/rjmcmc/Rpackage/serojump/outputs/fits/simulated_data/cop/figs/post/ab_kinetics_trajectories_High.png&quot;</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>modelname_sim <span class="ot">&lt;-</span> <span class="st">&quot;cesNoCOP_notd&quot;</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>sim_model_no_cop <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;outputs&quot;</span>, <span class="st">&quot;sim_data&quot;</span>, modelname_sim, <span class="st">&quot;inputs.RDS&quot;</span>))</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>sim_res_no_cop <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;outputs&quot;</span>, <span class="st">&quot;sim_data&quot;</span>, modelname_sim, <span class="fu">paste0</span>(<span class="st">&quot;sim_data_&quot;</span>, <span class="st">&quot;0.5&quot;</span>, <span class="st">&quot;.rds&quot;</span>)))</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="fu">plotMCMCDiagnosis</span>(model_summary_no_cop, <span class="at">save_info =</span> save_info_no_cop)</span></code></pre></div>
<pre><code>## --CHECKING SAVE_INFO DATA--
## Saving model outputs to:  /Users/lshdh2/Dropbox/Mac (3)/Documents/research/rjmcmc/Rpackage/serojump/outputs/fits/simulated_data/no_cop 
##  num [1:200, 1:200] -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...</code></pre>
<pre><code>## [1m[22mSaving 7.29 x 20 in image
## [1m[22m`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## [1m[22m`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## [1m[22mSaving 7.29 x 20 in image
## [1m[22m`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">plotPostFigsSim</span>(model_summary_no_cop, sim_model_no_cop, sim_res_no_cop, <span class="at">save_info =</span> save_info_no_cop)</span></code></pre></div>
<pre><code>## --CHECKING SAVE_INFO DATA--
## Saving model outputs to:  /Users/lshdh2/Dropbox/Mac (3)/Documents/research/rjmcmc/Rpackage/serojump/outputs/fits/simulated_data/no_cop</code></pre>
<pre><code>## [1m[22mJoining with `by = join_by(id)`
## Joining with `by = join_by(id)`
## Joining with `by = join_by(id)`
## `geom_smooth()` using formula = &#39;y ~ x&#39;
## Joining with `by = join_by(id)`
## Joining with `by = join_by(id)`
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## 
##  Get order of all entries, 
## Get exposure ids, 
## Get exposure ids1,</code></pre>
<pre><code>## [1m[22mAdding missing grouping variables: `biomarker`</code></pre>
<pre><code>## Get exposure ids2, 
## Get exposure ids3, 
## Get exposure ids3, 
## Calculate trajectories for for subsets of  none</code></pre>
<pre><code>## Calculate trajectories for for subsets of  High</code></pre>
<pre><code>## [[1]]
## [1] &quot;/Users/lshdh2/Dropbox/Mac (3)/Documents/research/rjmcmc/Rpackage/serojump/outputs/fits/simulated_data/no_cop/figs/post/ab_kinetics_trajectories_none.png&quot;
## 
## [[2]]
## [1] &quot;/Users/lshdh2/Dropbox/Mac (3)/Documents/research/rjmcmc/Rpackage/serojump/outputs/fits/simulated_data/no_cop/figs/post/ab_kinetics_trajectories_High.png&quot;</code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Hodgson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>
