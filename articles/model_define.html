<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Intro 2: Explanation of observational and antibody kinetics models • serojump</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Intro 2: Explanation of observational and antibody kinetics models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">serojump</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data_format.html">Intro 1: Data format for input files</a></li>
    <li><a class="dropdown-item" href="../articles/model_define.html">Intro 2: Explanation of observational and antibody kinetics models</a></li>
    <li><a class="dropdown-item" href="../articles/sim_recovery.html">Case Study 1: Simulation Recovery</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Intro 2: Explanation of observational and antibody kinetics models</h1>
                        <h4 data-toc-skip class="author">David
Hodgson</h4>
            
            <h4 data-toc-skip class="date">2024-10-14</h4>
      

      <div class="d-none name"><code>model_define.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document explains two critical parts of the model defined in the
provided R code:</p>
<ol style="list-style-type: decimal">
<li>The <strong>Observational Model</strong>: This component models the
observed data, specifying how the measured values relate to the latent
(unobserved) processes.</li>
<li>The <strong>Antibody Kinetics Model</strong>: This component models
the changes in antibody levels over time, accounting for both natural
decay (waning) and infection-induced changes.</li>
</ol>
<hr>
</div>
<div class="section level2">
<h2 id="the-observational-model">0. The Observational Model<a class="anchor" aria-label="anchor" href="#the-observational-model"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: usethis</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">serojump</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: replacing previous import 'foreach::when' by 'purrr::when' when</span></span>
<span><span class="co">## loading 'serojump'</span></span></code></pre>
<pre><code><span><span class="co">## Warning: replacing previous import 'foreach::accumulate' by 'purrr::accumulate'</span></span>
<span><span class="co">## when loading 'serojump'</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="the-observational-model-1">1. The Observational Model<a class="anchor" aria-label="anchor" href="#the-observational-model-1"></a>
</h2>
<div class="section level3">
<h3 id="definition">Definition<a class="anchor" aria-label="anchor" href="#definition"></a>
</h3>
<p>The observational model captures the process by which observed data
(<code>PreF</code> in this case) is generated from the underlying
system. It defines the relationship between the true (latent) variables
and the observed data.</p>
</div>
<div class="section level3">
<h3 id="code-breakdown">Code Breakdown<a class="anchor" aria-label="anchor" href="#code-breakdown"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obsLogLikelihood</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">titre_val</span>, <span class="va">titre_est</span>, <span class="va">pars</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">titre_val</span>, <span class="va">titre_est</span>, <span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">ll</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">observationalModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IgG"</span><span class="op">)</span>,</span>
<span>    model <span class="op">=</span> <span class="fu"><a href="../reference/makeModel.html">makeModel</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="../reference/addObservationalModel.html">addObservationalModel</a></span><span class="op">(</span><span class="st">"IgG"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sigma"</span><span class="op">)</span>, <span class="va">obsLogLikelihood</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    prior <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="../reference/add_par_df.html">add_par_df</a></span><span class="op">(</span><span class="st">"sigma"</span>, <span class="fl">0.0001</span>, <span class="fl">4</span>, <span class="st">"unif"</span>, <span class="fl">0.0001</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="co"># observational model,</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p><strong><code>names = c("IgG")</code></strong>: The observed
biomarker here is <code>IgG</code>, representing some measurement, such
as a biomarker (e.g., antibody concentration).</p></li>
<li><p><strong><code>model = makeModel(...)</code></strong>: The model
is created using the <code>makeModel</code> function, which defines how
the observation model is constructed.</p></li>
<li><p><strong><code>addObservationalModel("IgG", c("sigma"), obsLogLikelihood)</code></strong>:
This line adds an observational model for <code>IgG</code>, where the
parameter <code>sigma</code> is used to model the noise or uncertainty
in the observations. The log-likelihood function
(<code>obsLogLikelihood</code>) is used to define how the observations
relate to the latent variable.</p></li>
<li><p><strong><code>prior = bind_rows(...)</code></strong>: This block
defines the prior distribution for the parameter <code>sigma</code>,
which controls the observation noise.</p></li>
<li><p><strong><code>add_par_df("sigma", 0.0001, 4, "unif", 0.0001, 4)</code></strong>:
The parameter <code>sigma</code> is given a uniform prior distribution
between <code>0.0001</code> and <code>4</code>, indicating that the
model expects a certain range of variability in the observed
data.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>The observational model defines how the <code>IgG</code> variable is
observed with some noise, controlled by <code>sigma</code>. The
log-likelihood function helps relate the true underlying values to the
observed values, while the prior on <code>sigma</code> assumes uniform
uncertainty.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-antibody-kinetics-model">2. The Antibody Kinetics Model<a class="anchor" aria-label="anchor" href="#the-antibody-kinetics-model"></a>
</h2>
<div class="section level3">
<h3 id="definition-1">Definition<a class="anchor" aria-label="anchor" href="#definition-1"></a>
</h3>
<p>The antibody kinetics model describes how antibody levels evolve over
time in response to different factors, such as infection or natural
waning. This model accounts for both natural decay in antibody levels
and changes due to infection.</p>
</div>
<div class="section level3">
<h3 id="code-breakdown-1">Code Breakdown<a class="anchor" aria-label="anchor" href="#code-breakdown-1"></a>
</h3>
<p>Define the antibody kinetic functions</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">noInfSerumKinetics</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">titre_est</span>, <span class="va">timeSince</span>, <span class="va">pars</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">titre_est_new</span> <span class="op">&lt;-</span> <span class="va">titre_est</span> <span class="op">-</span> <span class="op">(</span><span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">titre_est</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">timeSince</span><span class="op">)</span></span>
<span>    <span class="va">titre_est_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">titre_est_new</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="va">titre_est_new</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">infTuenisPower2016</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">titre_est</span>, <span class="va">timeSince</span>, <span class="va">pars</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>    <span class="va">y1</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">t1</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="va">r</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>    <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fl">0.001</span></span>
<span>    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">t1</span> <span class="op">*</span> <span class="va">y1</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">timeSince</span> <span class="op">&lt;</span> <span class="va">t1</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">titre_est_boost</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">mu</span> <span class="op">*</span> <span class="va">timeSince</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">titre_est_boost</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">r</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">^</span><span class="op">{</span><span class="va">r</span> <span class="op">-</span> <span class="fl">1</span><span class="op">}</span> <span class="op">*</span> <span class="va">v</span> <span class="op">*</span> <span class="op">(</span><span class="va">timeSince</span> <span class="op">-</span> <span class="va">t1</span><span class="op">)</span><span class="op">)</span> <span class="op">^</span> <span class="op">{</span><span class="op">-</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">r</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">titre_est_log</span> <span class="op">&lt;-</span> <span class="va">titre_est</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">titre_est_boost</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">titre_est</span> <span class="op">*</span> <span class="va">alpha</span><span class="op">)</span></span>
<span>    <span class="va">titre_est_log</span> </span>
<span><span class="op">}</span></span></code></pre></div>
<p>Create the antibody kinetics model</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">abkineticsModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    model <span class="op">=</span> <span class="fu"><a href="../reference/makeModel.html">makeModel</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="../reference/addAbkineticsModel.html">addAbkineticsModel</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"IgG"</span>, <span class="st">"none"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wane"</span><span class="op">)</span>, <span class="va">noInfSerumKinetics</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="../reference/addAbkineticsModel.html">addAbkineticsModel</a></span><span class="op">(</span><span class="st">"inf"</span>, <span class="st">"IgG"</span>, <span class="st">"inf"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y1_h1"</span>, <span class="st">"t1_h1"</span>, <span class="st">"r_h1"</span>, <span class="st">"s"</span><span class="op">)</span>, <span class="va">infTuenisPower2016</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    prior <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="../reference/add_par_df.html">add_par_df</a></span><span class="op">(</span><span class="st">"y1_h1"</span>, <span class="fl">1</span>, <span class="fl">6</span>, <span class="st">"unif"</span>,  <span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="../reference/add_par_df.html">add_par_df</a></span><span class="op">(</span><span class="st">"t1_h1"</span>, <span class="fl">3</span>, <span class="fl">14</span>, <span class="st">"unif"</span>, <span class="fl">3</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="../reference/add_par_df.html">add_par_df</a></span><span class="op">(</span><span class="st">"r_h1"</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="st">"unif"</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="../reference/add_par_df.html">add_par_df</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="st">"unif"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="../reference/add_par_df.html">add_par_df</a></span><span class="op">(</span><span class="st">"wane"</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="st">"unif"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p><strong><code>model = makeModel(...)</code></strong>: The
antibody kinetics model is built using <code>makeModel</code>, which
defines two different antibody response models.</p></li>
<li><p><strong><code>addAbkineticsModel("none", "PreF", "none", c("wane"), noInfSerumKinetics)</code></strong>:
This line models the antibody kinetics when there is <strong>no
infection</strong>. The “PreF” biomarker is modeled with the parameter
<code>wane</code>, which represents the natural decay or waning of
antibody levels over time. The <code>noInfSerumKinetics</code> function
describes this process.</p></li>
<li>
<p><strong><code>addAbkineticsModel("inf", "PreF", "inf", c("y1_h1", "t1_h1", "r_h1", "s"), infTuenisPower2016)</code></strong>:
This line models the antibody kinetics <strong>after infection</strong>.
Several parameters describe the response to infection:</p>
<ul>
<li>
<strong><code>y1_h1</code></strong>: Initial antibody level
post-infection.</li>
<li>
<strong><code>t1_h1</code></strong>: Time of peak response.</li>
<li>
<strong><code>r_h1</code></strong>: Rate of antibody decay
post-infection.</li>
<li>
<strong><code>s</code></strong>: Slope of decay after peak
response.</li>
<li>
<strong><code>infTuenisPower2016</code></strong>: The function
governing the infection-induced antibody response.</li>
</ul>
</li>
<li>
<p><strong><code>prior = bind_rows(...)</code></strong>: This block
defines prior distributions for the model parameters:</p>
<ul>
<li>
<strong><code>y1_h1</code></strong>: Uniform prior between
<code>1</code> and <code>6</code>, representing the initial antibody
level after infection.</li>
<li>
<strong><code>t1_h1</code></strong>: Normal prior with mean
<code>14</code> and standard deviation <code>3</code>, representing the
time to peak response.</li>
<li>
<strong><code>r_h1</code></strong>: Uniform prior between
<code>1</code> and <code>5</code>, representing the rate of antibody
decay.</li>
<li>
<strong><code>s</code></strong>: Uniform prior between
<code>0</code> and <code>1</code>, representing the slope of the decay
post-infection.</li>
<li>
<strong><code>wane</code></strong>: Uniform prior between
<code>0</code> and <code>1</code>, representing the natural waning of
antibody levels over time.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="summary-1">Summary<a class="anchor" aria-label="anchor" href="#summary-1"></a>
</h3>
<p>The antibody kinetics model accounts for the natural waning of
antibodies in the absence of infection, as well as the antibody response
after infection. Parameters such as <code>y1_h1</code>,
<code>t1_h1</code>, and <code>r_h1</code> govern the kinetics of
antibody production and decay. The model uses both uniform and normal
priors to specify reasonable ranges for these parameters.</p>
</div>
</div>
<div class="section level2">
<h2 id="full-model-definition">3. Full model definition<a class="anchor" aria-label="anchor" href="#full-model-definition"></a>
</h2>
<p>This R code defines a serological model using different components
such as biomarkers, exposure types, observational and antibody kinetics
models, and priors. The code creates a model definitions
(<code>modeldefinition_e1_p1</code>) and uses these to create a
serological model for data analysis
(<code>seroModel_phirst_e1_p1</code>).</p>
</div>
<div class="section level2">
<h2 id="step-by-step-breakdown">Step-by-Step Breakdown<a class="anchor" aria-label="anchor" href="#step-by-step-breakdown"></a>
</h2>
<div class="section level3">
<h3 id="step-1-define-the-first-model-modeldefinition">Step 1: Define the First Model <code>modeldefinition</code><a class="anchor" aria-label="anchor" href="#step-1-define-the-first-model-modeldefinition"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># See data_format.Rmd vignette about data input types </span></span>
<span></span>
<span><span class="va">biomarkers</span> <span class="op">&lt;-</span> <span class="st">"IgG"</span></span>
<span></span>
<span><span class="co"># Create the data_sero dataframe</span></span>
<span><span class="va">data_sero</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">50</span>, <span class="fl">1</span>, <span class="fl">50</span>, <span class="fl">1</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  IgG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">4.4</span>, <span class="fl">1.2</span>, <span class="fl">4.4</span>, <span class="fl">3.0</span>, <span class="fl">3.0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define possible exposure types</span></span>
<span><span class="va">exposureTypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"inf"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the exposure_data dataframe</span></span>
<span><span class="va">exposure_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span><span class="op">)</span>,</span>
<span>  exposure_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">exposureFitted</span> <span class="op">&lt;-</span> <span class="st">"inf"</span></span>
<span></span>
<span><span class="co"># Create the attack_rate_data dataframe</span></span>
<span><span class="va">attack_rate_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span>,</span>
<span>  prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">modeldefinition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    biomarkers <span class="op">=</span> <span class="va">biomarkers</span>,</span>
<span>    exposureTypes <span class="op">=</span> <span class="va">exposureTypes</span>,</span>
<span>    exposureFitted <span class="op">=</span> <span class="va">exposureFitted</span>,</span>
<span>    observationalModel <span class="op">=</span> <span class="va">observationalModel</span>,</span>
<span>    abkineticsModel <span class="op">=</span> <span class="va">abkineticsModel</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">seroModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createSeroJumpModel.html">createSeroJumpModel</a></span><span class="op">(</span><span class="va">data_sero</span>, <span class="cn">NULL</span>, <span class="va">modeldefinition</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## OUTLINE OF INPUTTED MODEL</span></span>
<span><span class="co">## There are  1  measured biomarkers:  IgG </span></span>
<span><span class="co">## There are  2  exposure types in the study period:  none, inf </span></span>
<span><span class="co">## The fitted exposure type is  inf </span></span>
<span><span class="co">## PRIOR DISTRIBUTIONS </span></span>
<span><span class="co">## Prior parameters of observationalModel are:  sigma </span></span>
<span><span class="co">## Prior parameters of abkineticsModel are:  y1_h1, t1_h1, r_h1, s, wane </span></span>
<span><span class="co">## Exposure rate is not defined over the time period. Defaulting to uniform distribution between 1 and  50 .</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="run-the-model">4. Run the model!<a class="anchor" aria-label="anchor" href="#run-the-model"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">save_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    file_name <span class="op">=</span> <span class="st">"simple"</span>,</span>
<span>    model_name <span class="op">=</span> <span class="st">"ex1"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rj_settings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        numberChainRuns <span class="op">=</span> <span class="fl">4</span>, </span>
<span>        iterations <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>        burninPosterior <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>        thin <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runRJMCMC.html">runInfRJMCMC</a></span><span class="op">(</span><span class="va">seroModel</span>, <span class="va">rj_settings</span>, save_info <span class="op">=</span> <span class="va">save_info</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## --CHECKING SETTINGS LIST--</span></span>
<span><span class="co">## `numberCores` not specified in settings. Default value equal to `numberChainRuns`. </span></span>
<span><span class="co">## `consoleUpdates` not specified in settings. Default value 100. </span></span>
<span><span class="co">## `onAdaptiveCov` not specified in settings. Default value TRUE. </span></span>
<span><span class="co">## `updatesAdaptiveCov` not specified in settings. Default value 100. </span></span>
<span><span class="co">## `burninAdaptiveCov` not specified in settings. Default value 1000. </span></span>
<span><span class="co">## `onAdaptiveTemp` not specified in settings.  Default value TRUE. </span></span>
<span><span class="co">## `updatesAdaptiveTemp` not specified in settings.  Default value 10. </span></span>
<span><span class="co">## `covarInitVal` not specified in settings.  Default value 1e-10. </span></span>
<span><span class="co">## `covarInitValAdapt` not specified in settings.  Default value 1e-10. </span></span>
<span><span class="co">## `covarMaxVal` not specified in settings. Default value 1. </span></span>
<span><span class="co">## `noGibbsSteps` not specified in settings. Default value 1. </span></span>
<span><span class="co">## `runParallel` not specified in settings. Default value TRUE. </span></span>
<span><span class="co">## --CHECKING SAVE_INFO DATA--</span></span>
<span><span class="co">## Saving model outputs to:  /home/runner/work/serojump/serojump/outputs/fits/simple/ex1 </span></span>
<span><span class="co">## --CHECKING SETTINGS LIST--</span></span>
<span><span class="co">## Running MCMC-PT iteration number: 0 of 2000. Chain number 1. Current logpost: -28.5401. No exp/inf: 2/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 0 of 2000. Chain number 2. Current logpost: -23.1648. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 0 of 2000. Chain number 3. Current logpost: -28.1654. No exp/inf: 2/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 0 of 2000. Chain number 4. Current logpost: -46.781. No exp/inf: 2/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 100 of 2000. Chain number 1. Current logpost: -28.0499. No exp/inf: 2/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 100 of 2000. Chain number 2. Current logpost: -21.6933. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 100 of 2000. Chain number 3. Current logpost: -21.3911. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 100 of 2000. Chain number 4. Current logpost: -24.4807. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 200 of 2000. Chain number 3. Current logpost: -19.9803. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 200 of 2000. Chain number 1. Current logpost: -26.2545. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 200 of 2000. Chain number 4. Current logpost: -20.1003. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 200 of 2000. Chain number 2. Current logpost: -22.5318. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: Running MCMC-PT iteration number: 300300 of  of 20002000. Chain number . Chain number 13. Current logpost: . Current logpost: -14.243-26.94. No exp/inf: . No exp/inf: 33//00. </span></span>
<span><span class="co">## . </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 300 of 2000. Chain number 4. Current logpost: -19.2863. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 300 of 2000. Chain number 2. Current logpost: -19.2074. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 400 of 2000. Chain number 1. Current logpost: -27.7163. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 400 of 2000. Chain number 4. Current logpost: -3.2348. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 400 of 2000. Chain number 2. Current logpost: -8.8148. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 400 of 2000. Chain number 3. Current logpost: -13.4989. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 500 of 2000. Chain number 1. Current logpost: -19.6415. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 500 of 2000. Chain number 4. Current logpost: -2.95184. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 500 of 2000. Chain number 2. Current logpost: -6.21341. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 500 of 2000. Chain number 3. Current logpost: -12.7439. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 600 of 2000. Chain number 1. Current logpost: -10.5377. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 600 of 2000. Chain number 4. Current logpost: 5.19564. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 600 of 2000. Chain number 2. Current logpost: 5.33477. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 600 of 2000. Chain number 3. Current logpost: -4.61079. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 700 of 2000. Chain number 1. Current logpost: -7.20506. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 700 of 2000. Chain number 4. Current logpost: 9.73866. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 700 of 2000. Chain number 2. Current logpost: 2.52449. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 700 of 2000. Chain number 3. Current logpost: -5.10266. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 800 of 2000. Chain number 1. Current logpost: -4.32922. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 800 of 2000. Chain number 3. Current logpost: 3.0017. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 800 of 2000. Chain number 4. Current logpost: 11.5375. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 800 of 2000. Chain number 2. Current logpost: 6.41225. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 900 of 2000. Chain number 1. Current logpost: -6.04095. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 900 of 2000. Chain number 3. Current logpost: -1.99867. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 900 of 2000. Chain number 4. Current logpost: 11.3257. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 900 of 2000. Chain number 2. Current logpost: 5.14066. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1000 of 2000. Chain number 1. Current logpost: -1.36023. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1000 of 2000. Chain number 4. Current logpost: 4.69104. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1000 of 2000. Chain number 3. Current logpost: -1.12957. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1000 of 2000. Chain number 2. Current logpost: 3.32283. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1100 of 2000. Chain number 1. Current logpost: -0.715359. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1100 of 2000. Chain number 4. Current logpost: 10.9716. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1100 of 2000. Chain number 3. Current logpost: 12.7875. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1100 of 2000. Chain number 2. Current logpost: 6.58441. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1200 of 2000. Chain number 1. Current logpost: 0.355886. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1200 of 2000. Chain number 4. Current logpost: 20.1593. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1200 of 2000. Chain number 3. Current logpost: 11.3122. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1200 of 2000. Chain number 2. Current logpost: 8.14896. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1300 of 2000. Chain number 1. Current logpost: -3.05332. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1300 of 2000. Chain number 3. Current logpost: 11.1761. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1300 of 2000. Chain number 4. Current logpost: 24.6653. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1300 of 2000. Chain number 2. Current logpost: 0.332339. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1400 of 2000. Chain number 1. Current logpost: -6.87434. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1400 of 2000. Chain number 3. Current logpost: 16.0124. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1400 of 2000. Chain number 4. Current logpost: 25.2462. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1400 of 2000. Chain number 2. Current logpost: 8.13425. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1500 of 2000. Chain number 1. Current logpost: -0.341167. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1500 of 2000. Chain number 4. Current logpost: 25.8561. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1500 of 2000. Chain number 3. Current logpost: 20.6673. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1500 of 2000. Chain number 2. Current logpost: 10.9637. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1600 of 2000. Chain number 1. Current logpost: 0.784569. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1600 of 2000. Chain number 4. Current logpost: 23.6427. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1600 of 2000. Chain number 3. Current logpost: 27.0434. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1600 of 2000. Chain number 2. Current logpost: 15.745. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1700 of 2000. Chain number 1. Current logpost: 7.38068. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1700 of 2000. Chain number 3. Current logpost: 16.6758. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1700 of 2000. Chain number 4. Current logpost: 26.3399. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1700 of 2000. Chain number 2. Current logpost: 19.3861. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1800 of 2000. Chain number 1. Current logpost: 20.7758. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1800 of 2000. Chain number 3. Current logpost: 22.3844. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1800 of 2000. Chain number 4. Current logpost: 28.6416. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1800 of 2000. Chain number 2. Current logpost: 26.8599. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1900 of 2000. Chain number 1. Current logpost: 21.4314. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1900 of 2000. Chain number 3. Current logpost: 23.7098. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1900 of 2000. Chain number 4. Current logpost: 30.8612. No exp/inf: 3/0. </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 1900 of 2000. Chain number 2. Current logpost: 24.4618. No exp/inf: 3/0.</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: ggdist</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="plot-the-outputs">5. Plot the outputs<a class="anchor" aria-label="anchor" href="#plot-the-outputs"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Need to have save_info model_summary to run these</span></span>
<span><span class="fu"><a href="../reference/plotMCMCDiagnosis.html">plotMCMCDiagnosis</a></span><span class="op">(</span><span class="va">model_summary</span>, save_info <span class="op">=</span> <span class="va">save_info</span><span class="op">)</span> <span class="co"># plots the convergence diagnosis</span></span></code></pre></div>
<pre><code><span><span class="co">## --CHECKING SAVE_INFO DATA--</span></span>
<span><span class="co">## Saving model outputs to:  /home/runner/work/serojump/serojump/outputs/fits/simple/ex1 </span></span>
<span><span class="co">##  num [1:1000, 1:3] 36.3 36.3 36.3 36.3 36.3 ...</span></span></code></pre>
<pre><code><span><span class="co">## Saving 7.29 x 20 in image</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span>
<span><span class="co">## Loading required package: bayesplot</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## This is bayesplot version 1.11.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## - Online documentation and vignettes at mc-stan.org/bayesplot</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## - bayesplot theme set to bayesplot::theme_default()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    * Does _not_ affect other ggplot2 plots</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    * See ?bayesplot_theme_set for details on theme setting</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Loading required package: posterior</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## This is posterior version 1.6.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'posterior'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:bayesplot':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     rhat</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     mad, sd, var</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     %in%, match</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Saving 7.29 x 20 in image</span></span>
<span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span>
<span><span class="co">## Loading required package: data.table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'data.table'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following objects are masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     between, first, last</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Specifying the `id_cols` argument by position was deprecated in tidyr 1.3.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please explicitly name `id_cols`, like `id_cols = !chain`.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">serojump</span> package.</span></span>
<span><span class="co">##   Please report the issue to the authors.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plotPostFigs</span><span class="op">(</span><span class="va">model_summary</span>, save_info <span class="op">=</span> <span class="va">save_info</span><span class="op">)</span> <span class="co">#plots some plots of the posteriors</span></span></code></pre></div>
<pre><code><span><span class="co">## --CHECKING SAVE_INFO DATA--</span></span>
<span><span class="co">## Saving model outputs to:  /home/runner/work/serojump/serojump/outputs/fits/simple/ex1</span></span></code></pre>
<pre><code><span><span class="co">## Joining with `by = join_by(id)`</span></span>
<span><span class="co">## Joining with `by = join_by(id)`</span></span>
<span><span class="co">## Joining with `by = join_by(id)`</span></span>
<span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<pre><code><span><span class="co">## waney1_h1 t1_h1 r_h1 s</span></span></code></pre>
<pre><code><span><span class="co">## Joining with `by = join_by(id)`</span></span>
<span><span class="co">## Joining with `by = join_by(id)`</span></span>
<span><span class="co">## Loading required package: future</span></span></code></pre>
<pre><code><span><span class="co">## Warning in checkNumberOfLocalWorkers(workers): Careful, you are setting up 8</span></span>
<span><span class="co">## localhost parallel workers with only 4 CPU cores available for this R process</span></span>
<span><span class="co">## (per 'system'), which could result in a 200% load. The soft limit is set to</span></span>
<span><span class="co">## 100%. Overusing the CPUs has negative impact on the current R process, but also</span></span>
<span><span class="co">## on all other processes of yours and others running on the same machine. See</span></span>
<span><span class="co">## help("parallelly.options", package = "parallelly") for how to override the soft</span></span>
<span><span class="co">## and hard limits</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Get order of all entries, </span></span>
<span><span class="co">## Get exposure ids, </span></span>
<span><span class="co">## Get exposure ids1,</span></span></code></pre>
<pre><code><span><span class="co">## Adding missing grouping variables: `biomarker`</span></span></code></pre>
<pre><code><span><span class="co">## Get exposure ids2, </span></span>
<span><span class="co">## Get exposure ids3, </span></span>
<span><span class="co">## Get exposure ids3, </span></span>
<span><span class="co">## Calculate trajectories for for subsets of  none</span></span></code></pre>
<pre><code><span><span class="co">## Calculate trajectories for for subsets of  High</span></span></code></pre>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## [1] "/home/runner/work/serojump/serojump/outputs/fits/simple/ex1/figs/post/ab_kinetics_trajectories_none.png"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## [1] "/home/runner/work/serojump/serojump/outputs/fits/simple/ex1/figs/post/ab_kinetics_trajectories_High.png"</span></span></code></pre>
<p><code>model_summary$post</code> has all the posterior distributions
which the user can extract and plot themselves!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Hodgson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
